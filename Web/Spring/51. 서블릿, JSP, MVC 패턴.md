## JSP

### Dependency 추가

> build.gradle에 dependency 추가

```
dependencies {
	...
	implementation 'org.apache.tomcat.embed:tomcat-embed-jasper'
	implementation 'jakarta.servlet:jakarta.servlet-api'
	implementation 'jakarta.servlet.jsp.jstl:jakarta.servlet.jsp.jstl-api'
	implementation 'org.glassfish.web:jakarta.servlet.jsp.jstl'
	...
}
```

### 사용 예시

> <%@ page contentType="text/html;charset=UTF-8" language="java" %>
>
> JSP 문서임을 나타낸다.

> <%@ page import="hello.servlet.domain.member.MemberRepository" %>
>
> 자바의 import 문과 같다.

> <% ~~ %>
>
> 자바 코드를 입력할 수 있다.

> <%= ~~ %>
>
> 자바 코드를 출력할 수 있다.

> JSP 내장 객체는 바로 사용할 수 있다.

| 내장 객체   | 위치                                   | 설명                                                                                                   |
| ----------- | -------------------------------------- | ------------------------------------------------------------------------------------------------------ |
| request     | javax.servlet.http.HttpServletRequest  | 클라이언트에서 서버로의 HTTP 요청을 나타냄                                                             |
| response    | javax.servlet.http.HttpServletResponse | 서버에서 클라이언트로의 HTTP 응답을 나타냄                                                             |
| session     | javax.servlet.http.HttpSession         | 웹 애플리케이션에서 사용자 세션을 나타냄                                                               |
| application | javax.servlet.ServletContext           | 전체 웹 애플리케이션을 나타내며, 구성 및 환경 정보를 제공                                              |
| config      | javax.servlet.ServletConfig            | 서블릿의 구성을 나타냄                                                                                 |
| out         | javax.servlet.jsp.JspWriter            | 서블릿이나 JSP에서 클라이언트의 웹 브라우저로 콘텐츠(HTML, XML 등)를 보낼 수 있는 출력 스트림을 나타냄 |
| pageContext | javax.servlet.jsp.PageContext          | JSP 페이지 실행 중에 JSP 페이지와 관련된 여러 객체와 정보에 액세스할 수 있게 함                        |

```JSP
<%@ page import="java.util.List" %>
<%@ page import="hello.servlet.domain.member.MemberRepository" %>
<%@ page import="hello.servlet.domain.member.Member" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%  MemberRepository memberRepository = MemberRepository.getInstance();
    List<Member>
    members = memberRepository.findAll();
%>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Title</title>
    </head>
    <body>
        <table>
        <thead>
            <th>id</th>
            <th>username</th>
            <th>age</th>
        </thead>
        <tbody>
            <%
                for (Member member : members) {
                    out.write(" <tr>");
                    out.write(" <td>" + member.getId() + "</td>");
                    out.write(" <td>" + member.getUsername() + "</td>");
                    out.write(" <td>" + member.getAge() + "</td>");
                    out.write(" </tr>");
                }
            %>
        </tbody>
        </table>
    </body>
</html>

```

```JSP
<%@ page import="hello.servlet.domain.member.MemberRepository" %>
<%@ page import="hello.servlet.domain.member.Member" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%  MemberRepository memberRepository = MemberRepository.getInstance();
    String username = request.getParameter("username");
    int age = Integer.parseInt(request.getParameter("age"));
    Member member = new Member(username, age);
    memberRepository.save(member);
%>
<html>
  <head>
    <meta charset="UTF-8" />
  </head>
  <body>
    <ul>
      <li>id=<%=member.getId()%></li>
      <li>username=<%=member.getUsername()%></li>
      <li>age=<%=member.getAge()%></li>
    </ul>
  </body>
</html>
```

##

/WEB-INF
이 경로안에 JSP가 있으면 외부에서 직접 JSP를 호출할 수 없다. 우리가 기대하는 것은 항상 컨트롤러를 통해서
JSP를 호출하는 것이다.

```
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age"));

        Member member = new Member(username, age);
        System.out.println("member = " + member);
        memberRepository.save(member);

        //Model에 데이터를 보관한다.
        request.setAttribute("member", member);
        String viewPath = "/WEB-INF/views/save-result.jsp";
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request, response);
    }
```

```
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
 <meta charset="UTF-8">
</head>
<body>
성공
<ul>
 <li>id=${member.id}</li>
 <li>username=${member.username}</li>
 <li>age=${member.age}</li>
</ul>
<a href="/index.html">메인</a>
</body>
</html>
```
