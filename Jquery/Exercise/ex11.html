<!DOCTYPE html>
<html lang="ko">
  <head>
    <!-- ex11 -->
    <title>영화진흥위원회 Open API 활용</title>
    <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
    <script>
      //https://www.kobis.or.kr/kobisopenapi/homepg/main/main.do
      //https://www.kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchWeeklyBoxOfficeList.json?key=본인키&targetDt=20221212
      // 1. fetch 함수를 이용하여 json 정보를 출력하시오.

      fetch(
        "https://www.kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchWeeklyBoxOfficeList.json?key=33bdcaf0ab22c06861794d41fc1f5368&targetDt=20221212"
      )
        .then((response) => {
          return response.json();
        })
        .then((json) => {
          // console.log(JSON.stringify(json));
          console.log(
            "************************1. fetch 방법 이용************************"
          );
          var movieList = json["boxOfficeResult"];
          console.log("showRange:" + movieList["showRange"]); // 기간
          movieList = movieList["weeklyBoxOfficeList"];
          for (const obj of movieList) {
            console.log("rank: " + obj.rank); // 순위
            console.log("movieNm: " + obj.movieNm); // 이름
            console.log("audiCnt: " + obj.audiCnt); // 관객수
          }
        })
        .catch((error) => {
          console.log(error);
        });

      // 2. ajax 함수를 이용하여 json 정보를 출력하시오.

      $.ajax({
        dataType: "json",
        url: "https://www.kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchWeeklyBoxOfficeList.json?key=33bdcaf0ab22c06861794d41fc1f5368&targetDt=20221212",
        mimeType: "application/json",
        success: function (json) {
          console.log(
            "************************1. ajax 방법 이용************************"
          );
          var movieList = json["boxOfficeResult"];
          console.log("showRange:" + movieList["showRange"]); // 기간
          movieList = movieList["weeklyBoxOfficeList"];
          for (const obj of movieList) {
            console.log("rank: " + obj.rank); // 순위
            console.log("movieNm: " + obj.movieNm); // 이름
            console.log("audiCnt: " + obj.audiCnt); // 관객수
          }
        },
      });
    </script>
  </head>
  <body></body>
</html>
